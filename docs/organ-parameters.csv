# Organ Parameters and Rules
# Generated: 2026-02-06
# Version: v0.15.0

## UNIFIED DEGRADATION SYSTEM
# Both organs now use the same tier system: tiers 1-5
# Tier 1 = healthy (non-burnable base level)
# Tiers 2-5 = burnable (shown as 4 circles)
# Points per tier: 25 (unified for both organs)

## LIVER (Печень)
Parameter,Value,Unit,Description
liverCapacity,150,mg/dL,Maximum liver storage capacity
liverTransferRates[0],0,mg/dL/h,Tier 0 - Stop (BG >= 200)
liverTransferRates[1],50,mg/dL/h,Tier 1 - Normal release
liverTransferRates[2],75,mg/dL/h,Tier 2 - Liver Boost active
passThrough_threshold,95,%,Overflow pass-through activates at this fill level
passThrough_condition,Ship unloading AND no Liver Boost,,Pass-through only when ship is actively unloading

## LIVER RULES (Правила печени)
Priority,Rule ID,Condition,Action (Tier),Rate (mg/dL/h),Description
1,liver_boost_active,Liver Boost is active,2,75,Manual boost forces maximum rate
2,bg_high_stop,BG >= 200,0,0,Stop release when blood glucose high
3,bg_low_release,BG <= 100,1,50,Release glucose when BG low
4,default_normal,Default,1,50,Normal operation
*,pass_through,Liver >= 95% AND ship unloading,= ship rate,variable,Glucose pushed out at input rate

## LIVER DEGRADATION (Деградация печени)
Tier,Points Required,Capacity Reduction,Effective Capacity,Circles Shown
1 (healthy),0-24,0,150,0 (non-burnable)
2,25-49,20,130,1
3,50-74,30,120,2
4,75-99,40,110,3
5,100+,50,100,4

## PANCREAS (Поджелудочная железа) - NEW TIER SYSTEM v0.15.0
# Pancreas now has its own tier (insulin secretion tier)
# Pancreas tier determines base muscle tier
# Degradation limits maximum pancreas tier

Parameter,Value,Unit,Description
pancreasBasalTier,1,tier,Basal insulin tier at normal BG (70-150)
pancreasHighTier,4,tier,Insulin tier at high BG (>=150)
pancreasVeryHighTier,5,tier,Insulin tier at very high BG (>=200)
fastInsulinCooldown,3,hours,Cooldown after Fast Insulin activation
fastInsulinDuration,1,hour,How long Fast Insulin is active
fastInsulinTierBonus,1,tier,Tier bonus when Fast Insulin active

## PANCREAS RULES (Правила ПЖ - определяют tier инсулина)
Priority,Rule ID,Condition,Pancreas Tier,Description
1,bg_very_high_reaction,BG >= 200,5,Very high BG - maximum insulin at Tier 5
2,bg_high_reaction,BG >= 150,4,High BG - strong insulin at Tier 4
3,bg_low_reaction,BG <= 70,0,Low BG - disable insulin (prevent hypoglycemia)
4,default_basal,Default (BG 70-150),1,Normal BG - basal insulin at Tier 1

## PANCREAS MODIFIERS
Modifier ID,Condition,Effect,Description,Ignores Degradation
fast_insulin,Fast Insulin active,+1 tier,Manual boost increases tier,Yes

## PANCREAS DEGRADATION (Деградация ПЖ)
Tier,Points Required,Max Pancreas Tier Reduction,Effective Max Tier,Circles Shown
1 (healthy),0-24,0,5,0 (non-burnable)
2,25-49,1,4,1
3,50-74,2,3,2
4,75-99,3,2,3
5,100+,4,1,4

## MUSCLES (Мышцы)
# Muscle tier is now determined by pancreas tier (after degradation applied)
# Fast Insulin allows access to tier 6 and ignores degradation

Parameter,Value,Unit,Description
muscleDrainRates[0],0,mg/dL/h,Tier 0 - No drain
muscleDrainRates[1],35,mg/dL/h,Tier 1 - Basal
muscleDrainRates[2],40,mg/dL/h,Tier 2
muscleDrainRates[3],45,mg/dL/h,Tier 3
muscleDrainRates[4],50,mg/dL/h,Tier 4
muscleDrainRates[5],55,mg/dL/h,Tier 5 - Maximum normal
muscleDrainRates[6],60,mg/dL/h,Tier 6 - Boosted only (Fast Insulin)
minTier,0,tier,Minimum muscle tier
maxTier,5,tier,Maximum muscle tier (normal)
boostedMaxTier,6,tier,Maximum muscle tier (with Fast Insulin)

## MUSCLE MODIFIERS
Modifier ID,Condition,Effect,Description,Ignores Degradation
exercise_bonus,Exercise Effect > 50,+1 tier,Exercise increases drain,No
fast_insulin,Fast Insulin active,+1 tier,Boost increases drain,Yes

## MUSCLE TIER CALCULATION (NEW v0.15.0)
Step,Description
1,Get base tier from Pancreas rules (0, 1, 4, or 5 based on BG)
2,Apply Pancreas Degradation (unless Fast Insulin active)
3,Pass tier to muscles as base muscle tier
4,Apply Exercise modifier (+1 if exerciseEffect > 50)
5,Apply Fast Insulin modifier (+1 if active)
6,Clamp to [minTier ... effectiveMaxTier]
7,Look up drain rate from muscleDrainRates[tier]

## BG THRESHOLDS (Пороги глюкозы крови)
Threshold,Value,Unit,Description,Color
low,70,mg/dL,Hypoglycemia warning,Yellow
target,100,mg/dL,Optimal level,Green
pancreas_activate,150,mg/dL,Pancreas starts strong insulin (Tier 4),Orange
high,200,mg/dL,Liver stops / Pancreas max (Tier 5),Orange
critical,300,mg/dL,Accelerated degradation,Red
capacity,400,mg/dL,Maximum BG container,N/A

## DEGRADATION CALCULATION (Расчет деградации)
Zone,BG Range,Coefficient,Description
Normal,0-200,0,No degradation accumulation
High,200-300,0.5,Moderate degradation rate
Critical,300+,1.0,Full degradation rate (2x high zone)

## DEGRADATION POINTS TO TIER (Unified for both organs)
Points,Tier,Description
0-24,1,Healthy (non-burnable base level)
25-49,2,Light degradation (1 circle)
50-74,3,Moderate degradation (2 circles)
75-99,4,Severe degradation (3 circles)
100+,5,Maximum degradation (4 circles)

## BOOSTS CONFIGURATION
Boost,Cooldown,Duration,Charges (default),Effect,Ignores Degradation
Liver Boost,3 hours,1 hour,3,Forces Tier 2 (75 mg/dL/h) ignoring BG rules,No
Fast Insulin,3 hours,1 hour,3,+1 tier to pancreas/muscle + ignores degradation,Yes

## VISUAL INDICATORS (NEW v0.15.0)
Indicator,State,Color,Animation
Tier Circle,Healthy,Orange (#f97316),None
Tier Circle,Degraded,Pink (#ec4899),None
Tier Circle,Active,Red-Orange (#FF5900),Flashing (0.8s)
Tier Circle,Active+Boosted,Red-Orange (#FF5900),Fast Flashing (0.5s)
Tier Circle 6,Boosted Only,Red-Orange (#FF5900),Fast Flashing (0.5s)
Fast Insulin Button,Active,Red-Orange (#FF5900),Pulsing glow
